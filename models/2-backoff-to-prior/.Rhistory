nrow(d_exp2) #327
# select relevant utterances: negated know and think, QUD BEL?
d_exp2 = d_exp2 %>%
filter(predicate == "know" | predicate == "think") %>%
filter(valence == "neg")
table(d_exp2$utterance)
table(d_exp2$qud)
# calculate mean inference in exp2 to order utterances
means.utt = d_exp2 %>%
group_by(utterance) %>%
summarize(Mean = mean(responseCC))
means.utt
# calculate mean inference ratings in exp2 by QUD
means_exp2 = d_exp2 %>%
group_by(qud) %>%
summarize(Mean = mean(responseCC), CILow = ci.low(responseCC), CIHigh = ci.high(responseCC)) %>%
mutate(YMin = Mean - CILow, YMax = Mean + CIHigh) %>%
select(-c(CILow, CIHigh))
means_exp2
# relevel QUDs
means_exp2$qud <- factor(means_exp2$qud, levels = c("nai","ai"), labels = c("BEL?", "CC?"))
PL_agg.utt.qud$qud <- factor(PL_agg.utt.qud$qud, levels = c("mcQUD","ccQUD"), labels = c("BEL?", "CC?"))
# plot
ggplot(means_exp2, aes(x=qud, y=Mean)) +
geom_point(data=PL_agg.utt.qud, shape=21, aes(x=qud, y=prob), size = 3, color = "red", fill = "red") +
geom_point(size = 3, color="black",fill="black") +
geom_errorbar(aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
theme(legend.position="none") +
#scale_fill_manual(values=c("#E69F00","#56B4E9")) +
#guides(fill=guide_legend("QUD")) +
theme(axis.text.y = element_text(size=10)) +
scale_y_continuous(limits = c(0,1),breaks = c(0,.2,.4,.6,.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("BEL?"="BEL?", "CC?"="C?")) +
#scale_x_discrete(labels=c("BEL?"="Does Cole \n believe C?", "C?"="Does Charley \n speak Spanish?")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("Utterance") +
theme(axis.title.x=element_blank())
#ggsave("graphs/figures-for-SuB29-paper/P3-without-human.pdf",height=2.5,width=2.2)
ggsave("graphs/figures-for-SuB29-paper/P3-with-human.pdf",height=2.7,width=2.3)
# load required libraries
library(jsonlite)
library(tidyverse)
library(rwebppl)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
theme_set(theme_bw())
source('../helpers.R')
# read in the  model
model <- read_file("model.wppl")
model
# evaluate the model
eval_webppl <- function(command) {
webppl(paste(model,command,sep="\n"))
}
# load required libraries
library(jsonlite)
library(tidyverse)
library(rwebppl)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
theme_set(theme_bw())
source('../helpers.R')
# read in the  model
model <- read_file("model.wppl")
model
# read PL
PL = read_csv("data/PL.csv")
# load required libraries
library(jsonlite)
library(tidyverse)
library(rwebppl)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
theme_set(theme_bw())
source('../helpers.R')
# read PL
PL = read_csv("data/PL.csv")
nrow(PL) #36
# calculate mean inference strength across utterances
means.predicted = PL %>%
filter(state == "1") %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("bare",utterance) & qud == "mcQUD")) %>%
group_by(utterance,prior) %>%
summarize(Mean = mean(prob)) %>%
droplevels() %>%
mutate(data = "model") %>%
mutate(utterance = recode(utterance, "pos-bare-pos-dance" = "simple-pos",
"neg-bare-pos-dance" = "simple-neg",
"pos-know-pos-dance" = "know-pos",
"neg-know-pos-dance" = "know-neg",
"pos-think-pos-dance" = "think-pos",
"neg-think-pos-dance" = "think-neg"))
names(PL)
# calculate mean inference strength across utterances
means.predicted = PL %>%
filter(state == "1") %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("bare",utterance) & qud == "mcQUD")) %>%
group_by(utterance,ccPrior) %>%
summarize(Mean = mean(prob)) %>%
droplevels() %>%
mutate(data = "model") %>%
mutate(utterance = recode(utterance, "pos-bare-pos-dance" = "simple-pos",
"neg-bare-pos-dance" = "simple-neg",
"pos-know-pos-dance" = "know-pos",
"neg-know-pos-dance" = "know-neg",
"pos-think-pos-dance" = "think-pos",
"neg-think-pos-dance" = "think-neg"))
means.predicted
# add "simple-neg" with value 0 to model predictions
means.predicted <- as.data.frame(means.predicted)
tmp.data = data.frame(utterance = "simple-neg", Mean = 0, data = "model")
means.predicted = rbind(means.predicted, tmp.data)
# add "simple-neg" with value 0 to model predictions
means.predicted <- as.data.frame(means.predicted)
tmp.data = data.frame(utterance = "simple-neg", Mean = 0, ccPrior = "higher", data = "model")
tmp.data2 = data.frame(utterance = "simple-neg", Mean = 0, ccPrior = "lower", data = "model")
means.predicted = rbind(means.predicted, tmp.data, tmp.data2)
means.predicted
# load data from Exp 1 to compare to
d_exp1 <- read_csv("../../results/main/main01/data/cd.csv")
nrow(d_exp1) #873
names(d_exp1)
# calculate mean inference in exp 1 by utterance and prior, for default QUDs
means.exp1 = d_exp1 %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("simple",utterance) & qud == "mcQUD")) %>%
group_by(utterance, prior) %>%
summarize(Mean = mean(response), CILow = ci.low(response), CIHigh = ci.high(response)) %>%
mutate(YMin = Mean - CILow, YMax = Mean + CIHigh) %>%
select(-c(CILow, CIHigh)) %>%
mutate(data = "human")
means.exp1
# add fake YMin and YMax to the model predictions, for binding with human data
means.predicted = means.predicted %>%
mutate(YMin = 0) %>%
mutate(YMax = 0)
means.exp1
means.predicted
# change ccPrior to prior
means.predicted = means.predicted %>%
rename("ccPrior" = "prior")
# read PL
PL = read_csv("data/PL.csv")
nrow(PL) #36
names(PL)
# calculate mean inference strength across utterances
means.predicted = PL %>%
filter(state == "1") %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("bare",utterance) & qud == "mcQUD")) %>%
group_by(utterance,ccPrior) %>%
summarize(Mean = mean(prob)) %>%
droplevels() %>%
mutate(data = "model") %>%
mutate(utterance = recode(utterance, "pos-bare-pos-dance" = "simple-pos",
"neg-bare-pos-dance" = "simple-neg",
"pos-know-pos-dance" = "know-pos",
"neg-know-pos-dance" = "know-neg",
"pos-think-pos-dance" = "think-pos",
"neg-think-pos-dance" = "think-neg"))
means.predicted
# add "simple-neg" with value 0 to model predictions
means.predicted <- as.data.frame(means.predicted)
tmp.data = data.frame(utterance = "simple-neg", Mean = 0, ccPrior = "higher", data = "model")
tmp.data2 = data.frame(utterance = "simple-neg", Mean = 0, ccPrior = "lower", data = "model")
means.predicted = rbind(means.predicted, tmp.data, tmp.data2)
means.predicted
# change ccPrior to prior
means.predicted = means.predicted %>%
rename("prior" = "ccPrior")
means.predicted
# load data from Exp 1 to compare to
d_exp1 <- read_csv("../../results/main/main01/data/cd.csv")
nrow(d_exp1) #873
names(d_exp1)
# calculate mean inference in exp 1 by utterance and prior, for default QUDs
means.exp1 = d_exp1 %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("simple",utterance) & qud == "mcQUD")) %>%
group_by(utterance, prior) %>%
summarize(Mean = mean(response), CILow = ci.low(response), CIHigh = ci.high(response)) %>%
mutate(YMin = Mean - CILow, YMax = Mean + CIHigh) %>%
select(-c(CILow, CIHigh)) %>%
mutate(data = "human")
means.exp1
# add fake YMin and YMax to the model predictions, for binding with human data
means.predicted = means.predicted %>%
mutate(YMin = 0) %>%
mutate(YMax = 0)
means.exp1
means.predicted
tmp = rbind(means.predicted,means.exp1)
tmp
# relevel the utterances
tmp$utterance = factor(tmp$utterance, levels = means.exp1$utterance[order(means.exp1$Mean)], ordered = TRUE)
# relevel the utterances
means.exp1$utterance
means.exp1
means.exp1.noPrior = d_exp1 %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("simple",utterance) & qud == "mcQUD")) %>%
group_by(utterance) %>%
summarize(Mean = mean(response))
means.exp1.noPrior
# relevel the utterances
tmp$utterance = factor(tmp$utterance, levels = means.exp1$utterance[order(means.exp1.noPrior$Mean)], ordered = TRUE)
levels(tmp$utterance)
order(means.exp1.noPrior$Mean)
# relevel the utterances
tmp$utterance = factor(tmp$utterance, levels = means.exp1.noPrior$utterance[order(means.exp1.noPrior$Mean)], ordered = TRUE)
levels(tmp$utterance)
tmp$data = factor(tmp$data, levels = c("model","human"))
levels(tmp$data)
ggplot(tmp, aes(x=utterance, y=Mean, color=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
#geom_line(aes(group = interaction(data))) +
#geom_point(data=means.predicted, aes(x=utterance, y=mean.prob, group=1), color = "blue", size = 2) +
#geom_line(data=means.predicted,aes(x=utterance, y=mean.prob),color = "blue") +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
#facet_grid(content ~ .) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
#theme_classic() +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
#facet_grid(content ~ .) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
#theme_classic() +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, group = interaction(utterance, data))) +
geom_point(size = 3, fill=prior) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
#facet_grid(content ~ .) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
#theme_classic() +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, group = interaction(utterance, data))) +
geom_point(size = 3, aes(fill=prior)) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
#facet_grid(content ~ .) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
#theme_classic() +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, fill=prior, color=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
#facet_grid(content ~ .) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
#theme_classic() +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
#facet_grid(content ~ .) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
#theme_classic() +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(24,25)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
# relevel the prior
tmp$prior <- factor(tmp$prior, levels = c("lower","higher"))
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(24,25)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.2,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
#scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
scale_fill_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
scale_fill_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggsave("../../../../../../Downloads/results-by-utt-and-prior.pdf",height=3,width=6)
# load required libraries
library(jsonlite)
library(tidyverse)
library(rwebppl)
# set working directory
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
theme_set(theme_bw())
# read PL
PL = read_csv("data/PL.csv")
nrow(PL) #36
nrow(PL) #48
names(PL)
# calculate mean inference strength across utterances
means.predicted = PL %>%
filter(state == "1") %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("bare",utterance) & qud == "mcQUD")) %>%
group_by(utterance,ccPrior) %>%
summarize(Mean = mean(prob)) %>%
droplevels() %>%
mutate(data = "model") %>%
mutate(utterance = recode(utterance, "pos-bare-pos-dance" = "simple-pos",
"neg-bare-pos-dance" = "simple-neg",
"pos-know-pos-dance" = "know-pos",
"neg-know-pos-dance" = "know-neg",
"pos-think-pos-dance" = "think-pos",
"neg-think-pos-dance" = "think-neg"))
means.predicted
# add "simple-neg" with value 0 to model predictions
means.predicted <- as.data.frame(means.predicted)
# read PL
PL = read_csv("data/PL.csv")
nrow(PL) #48
names(PL)
# calculate mean inference strength across utterances
means.predicted = PL %>%
filter(state == "1") %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("bare",utterance) & qud == "mcQUD")) %>%
group_by(utterance,ccPrior) %>%
summarize(Mean = mean(prob)) %>%
droplevels() %>%
mutate(data = "model") %>%
mutate(utterance = recode(utterance, "pos-bare-pos-dance" = "simple-pos",
"neg-bare-pos-dance" = "simple-neg",
"pos-know-pos-dance" = "know-pos",
"neg-know-pos-dance" = "know-neg",
"pos-think-pos-dance" = "think-pos",
"neg-think-pos-dance" = "think-neg"))
means.predicted
# change ccPrior to prior
means.predicted = means.predicted %>%
rename("prior" = "ccPrior")
means.predicted
# load data from Exp 1 to compare to
d_exp1 <- read_csv("../../results/main/main01/data/cd.csv")
nrow(d_exp1) #873
names(d_exp1)
# calculate mean inference in exp 1 by utterance and prior, for default QUDs
means.exp1 = d_exp1 %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("simple",utterance) & qud == "mcQUD")) %>%
group_by(utterance, prior) %>%
summarize(Mean = mean(response), CILow = ci.low(response), CIHigh = ci.high(response)) %>%
mutate(YMin = Mean - CILow, YMax = Mean + CIHigh) %>%
select(-c(CILow, CIHigh)) %>%
mutate(data = "human")
means.exp1
means.exp1.noPrior = d_exp1 %>%
filter(!(grepl("know",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("think",utterance) & qud == "ccQUD")) %>%
filter(!(grepl("simple",utterance) & qud == "mcQUD")) %>%
group_by(utterance) %>%
summarize(Mean = mean(response))
means.exp1.noPrior
# add fake YMin and YMax to the model predictions, for binding with human data
means.predicted = means.predicted %>%
mutate(YMin = 0) %>%
mutate(YMax = 0)
means.exp1
means.predicted
tmp = rbind(means.predicted,means.exp1)
tmp
# relevel the utterances
tmp$utterance = factor(tmp$utterance, levels = means.exp1.noPrior$utterance[order(means.exp1.noPrior$Mean)], ordered = TRUE)
levels(tmp$utterance)
# relevel the data
tmp$data = factor(tmp$data, levels = c("model","human"))
levels(tmp$data)
# relevel the prior
tmp$prior <- factor(tmp$prior, levels = c("lower","higher"))
ggplot(tmp, aes(x=utterance, y=Mean, shape = prior, color=data, fill=data, group = interaction(utterance, data))) +
geom_point(size = 3) +
scale_shape_manual(values=c(25,24)) +
theme(legend.position="top") +
scale_color_manual(values = c("red","black")) +
scale_fill_manual(values = c("red","black")) +
geom_errorbar(data=tmp[tmp$data == "human",], aes(ymin=YMin,ymax=YMax),width=.05,color="black") +
scale_y_continuous(limits = c(0,1),breaks = c(0,0.2,0.4,0.6,0.8,1.0), labels = c("0",".2",".4",".6",".8","1")) +
scale_x_discrete(labels=c("simple-pos"="C", "simple-neg"="not C", "know-pos" = "Cole knows \n that C", "know-neg" = "Cole doesn't \n know that C",
"think-pos" = "Cole thinks \n that C", "think-neg" = "Cole doesn't \n think that C")) +
ylab("Predicted probability (red) \n Mean inference rating (black)") +
xlab("\nUtterance")
ggsave("../../../../../../Downloads/results-by-utt-and-prior.pdf",height=3,width=6)
